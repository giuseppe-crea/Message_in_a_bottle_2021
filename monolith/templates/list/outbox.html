{% extends 'body.html' %}
{% block content %}
    <script>
    function deleteRecord(url) {
        var xhr = new XMLHttpRequest();
        xhr.open("DELETE", url);
        xhr.send();
        xhr.onload = function() {
            if (xhr.status != 200) {
                console.log('ERROR');
            } else {
                console.log('DELETED!');
            }
            location.reload();
        };
        xhr.onerror = function() {
            console.log('NO CONNECTION');
        };
    }
    </script>
<h1>Welcome to your Sent Messages folder!</h1>
    <div>
        <h2>Messages Already Delivered:</h2>
        <ul style="list-style-type: none;">
            {% for message in delivered %}
                <li><b>to:</b> {{ message['receiver_email'] }}</li>
                <a href="outbox/{{message['id']}}">Read more...</a> or <a onclick=deleteRecord("inbox/{{message['id']}}") href="#">Delete</a>
                <br>
            {% endfor %}
        </ul>
    </div>
    <div>
        <h2>Messages Pending Delivery:</h2>
        <ul style="list-style-type: none;">
            {% for message in pending %}
                <li><b>to:</b> {{ message['receiver_email'] }}</li>
                <a href="outbox/{{message['id']}}">Read more...</a> or <a onclick=deleteRecord("inbox/{{message['id']}}") href="#">Delete</a>
                <br>
            {% endfor %}
        </ul>
    </div>
{% endblock %}
