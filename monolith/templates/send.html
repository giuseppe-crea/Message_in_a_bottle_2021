<!--suppress ALL -->

<html>
 <head>
     <script>
         // fill the recipient form input, if necessary
         function set_recipients(){
            // retrieve the URL
            const queryString = window.location.search;
            // retrieve the string of parameters
            const urlParams = new URLSearchParams(queryString);
            // check if data are passed through a GET request
            if(urlParams.has('data')){
                // retrieve the value
                const recipients = urlParams.get('data');
                // set the input field
                document.getElementById('recipient').setAttribute('value', recipients);
            }
         }
     </script>
     <title>Send a Message</title>
 </head>
 <body onload="set_recipients()"> <!-- to set through the DOM the selected recipients passed as GET parameters -->
  <form action="" method="POST">
    {{ form.hidden_tag() }}
    <dl>
     {% for field in form.display %}
     <dt>{{ form[field].label }}</dt>
     <dd>{{ form[field]() }}</dd>
       {% if form[field].errors %}
          {% for e in form[field].errors %}
           <p class="help-block">{{ e }}</p>
          {% endfor %}
       {% endif %}
     {% endfor %}
    </dl>
    <p>
    See a <a href="/list_of_recipients">list</a> of possible recipients
    <br> <br>
    <input type=submit name="save_button" value="Save"> or
        <input type=submit name="send_button" value="Send">
  </form>
 <a href="/logout">logout</a>
 </body>
</html>
